---
layout: default
---
<article class="page" itemscope itemtype="https://schema.org/CreativeWork">
  <!-- Title -->
  <h1 itemprop="name">{{ page.title }}</h1>
  {%- comment -%} Per-item announcement banner (shows only within active date window) {%- endcomment -%}
  {%- assign now_epoch = site.time | date: '%s' | plus: 0 -%}
  {%- assign show_announce = true -%}

  {%- if page.announce_start and page.announce_start != '' -%}
    {%- assign announce_start_epoch = page.announce_start | date: '%s' | plus: 0 -%}
    {%- if announce_start_epoch > now_epoch -%}
      {%- assign show_announce = false -%}
    {%- endif -%}
  {%- endif -%}

  {%- if page.announce_end and page.announce_end != '' -%}
    {%- assign announce_end_epoch = page.announce_end | date: '%s' | plus: 0 -%}
    {%- if now_epoch > announce_end_epoch -%}
      {%- assign show_announce = false -%}
    {%- endif -%}
  {%- endif -%}

  {%- if show_announce and (page.announce_title or page.announce_text) -%}
    <section class="announce">
      <span class="announce-badge">Update</span>
      <div class="announce-body">
        {%- if page.announce_title -%}
          <div class="announce-title">{{ page.announce_title }}</div>
        {%- endif -%}

        {%- if page.announce_start or page.announce_end -%}
          <div class="announce-date">
            {%- if page.announce_start -%}
              {{ page.announce_start | date: "%b %-d, %Y" }}
            {%- endif -%}
            {%- if page.announce_start and page.announce_end -%} &mdash; {%- endif -%}
            {%- if page.announce_end -%}
              {{ page.announce_end | date: "%b %-d, %Y" }}
            {%- endif -%}
          </div>
        {%- endif -%}

        {%- if page.announce_text -%}
          <div class="announce-text">
            {{ page.announce_text | markdownify }}
          </div>
        {%- endif -%}

        {%- if page.announce_link_url and page.announce_link_label -%}
          <div class="cta-row" style="margin-top:.4rem;">
            <a class="btn primary" href="{{ page.announce_link_url }}" target="_blank" rel="noopener">{{ page.announce_link_label }}</a>
          </div>
        {%- endif -%}
      </div>
    </section>
  {%- endif -%}

  <!-- HERO IMAGE (clickable for lightbox) -->
  {% if page.photos and page.photos[0] %}
    <figure class="project-image" style="margin-top:.5rem;">
      <a
        class="gallery-item"
        href="{{ page.photos[0] | relative_url }}"
        data-full="{{ page.photos[0] | relative_url }}"
        data-alt="{{ page.title | escape }}"
        data-caption="{{ page.summary | escape }}"
        aria-label="Open image"
      >
        <img src="{{ page.photos[0] | relative_url }}" alt="{{ page.title }}" itemprop="image">
      </a>
    </figure>
  {% endif %}

  <!-- TAG PILLS directly under hero -->
  {% if page.tags %}
    <div class="tags" aria-label="Tags">
      {% for t in page.tags %}
        <span class="tag">{{ t }}</span>
      {% endfor %}
    </div>
  {% endif %}

  <!-- SUMMARY (lead) -->
  {% if page.summary %}
    <p class="lead" itemprop="abstract" style="margin-top:.25rem;">{{ page.summary }}</p>
  {% endif %}

  <!-- DETAIL or BODY COPY -->
  {% if page.detail %}
    <div class="content" itemprop="text">
      {{ page.detail | markdownify }}
    </div>
  {% else %}
    <div class="content" itemprop="text">
      {{ content }}
    </div>
  {% endif %}

  <!-- CONTACT CTA (appears after content; disable per page with contact_button: false) -->
  {% if page.contact_button != false %}
    <div class="cta-row" style="margin-top:1rem;">
      {% if page.button_type == "custom" %}
        {% include custom_button.html title=page.title %}
      {% elsif page.button_type == "order" %}
        {% include button.html title=page.title %}
      {% elsif page.square_url or page.makerworld_url %}
        {% include button.html title=page.title %}
      {% else %}
        {% include custom_button.html title=page.title %}
      {% endif %}
    </div>
  {% endif %}

  <!-- CTAs AFTER content -->
  {% if page.square_url or page.makerworld_url %}
    <div class="cta-row" style="margin-top:1rem;">
      {% if page.square_url %}
        <a class="btn primary" href="{{ page.square_url }}" target="_blank" rel="noopener">Buy on Square</a>
      {% endif %}
      {% if page.makerworld_url %}
        <a class="btn" href="{{ page.makerworld_url }}" target="_blank" rel="noopener">Download on Makerworld</a>
      {% endif %}
    </div>
  {% endif %}

  <!-- Additional photos grid (lightbox-enabled) -->
  {% if page.photos and page.photos.size > 1 %}
    <h2 style="margin-top:1.25rem;">Gallery</h2>
    <div class="card-grid">
      {% for p in page.photos offset:1 %}
        <div class="card">
          <a
            class="gallery-item"
            href="{{ p | relative_url }}"
            data-full="{{ p | relative_url }}"
            data-alt="{{ page.title | escape }}"
            data-caption="{{ page.summary | escape }}"
            aria-label="Open image"
          >
            <img src="{{ p | relative_url }}" alt="">
          </a>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Prev/Next within the portfolio collection -->
  {% assign items = site.portfolio | sort: 'date' %}
  {% assign curr_index = nil %}
  {% for it in items %}
    {% if it.url == page.url %}
      {% assign curr_index = forloop.index0 %}
    {% endif %}
  {% endfor %}

  {% if curr_index != nil %}
    {% assign prev_index = curr_index | minus: 1 %}
    {% assign next_index = curr_index | plus: 1 %}
    {% assign prev_item = items[prev_index] %}
    {% assign next_item = items[next_index] %}
    <nav class="pager" aria-label="Portfolio pagination" style="margin-top:1.5rem; display:flex; justify-content:space-between; gap:1rem;">
      <div>
        {% if prev_item %}
          <a class="btn" href="{{ prev_item.url | relative_url }}">← Previous</a>
        {% endif %}
      </div>
      <div>
        {% if next_item %}
          <a class="btn" href="{{ next_item.url | relative_url }}">Next →</a>
        {% endif %}
      </div>
    </nav>
  {% endif %}

{%- comment -%} RELATED PROJECTS (GitHub Pages–compatible) {%- endcomment -%}
{%- assign related = "" | split: "" -%}
{%- for it in site.portfolio -%}
  {%- if it.url != page.url -%}
    {%- assign has_overlap = false -%}
    {%- if it.tags and page.tags -%}
      {%- for t in it.tags -%}
        {%- if page.tags contains t -%}
          {%- assign has_overlap = true -%}
        {%- endif -%}
      {%- endfor -%}
    {%- endif -%}
    {%- if has_overlap -%}
      {%- assign related = related | push: it -%}
    {%- endif -%}
  {%- endif -%}
{%- endfor -%}

{%- assign pool = related -%}
{%- if pool.size == 0 -%}
  {%- assign pool = "" | split: "" -%}
  {%- for it in site.portfolio -%}
    {%- if it.url != page.url -%}
      {%- assign pool = pool | push: it -%}
    {%- endif -%}
  {%- endfor -%}
{%- endif -%}

{%- assign shown = pool | sort: "date" | reverse | slice: 0, 3 -%}

{% if shown.size > 0 %}
  <h2 style="margin-top:1.25rem;">Related Projects</h2>
  <div class="card-grid">
    {% for item in shown %}
      <article class="card">
        {% if item.photos and item.photos[0] %}
          <a
            class="gallery-item"
            href="{{ item.photos[0] | relative_url }}"
            data-full="{{ item.photos[0] | relative_url }}"
            data-alt="{{ item.title | escape }}"
            data-caption="{{ item.summary | default: '' | escape }}"
            aria-label="Open image"
          >
            <img src="{{ item.photos[0] | relative_url }}" alt="{{ item.title | escape }}">
          </a>
        {% endif %}
        <div class="pad">
          <h3><a href="{{ item.url | relative_url }}">{{ item.title }}</a></h3>
          {% if item.summary %}<p>{{ item.summary }}</p>{% endif %}
        </div>
      </article>
    {% endfor %}
  </div>
{% endif %}

</article>