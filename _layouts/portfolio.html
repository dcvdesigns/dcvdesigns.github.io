---
layout: default
---
<article class="page" itemscope itemtype="https://schema.org/CreativeWork">
  <h1 itemprop="name">{{ page.title }}</h1>

  {% if page.photos and page.photos[0] %}
    <div class="project-image">
      <a
        class="gallery-item"
        href="{{ page.photos[0] | relative_url }}"
        data-full="{{ page.photos[0] | relative_url }}"
        data-alt="{{ page.title | escape }}"
        data-caption="{{ page.summary | escape }}"
        aria-label="Open image"
      >
        <img src="{{ page.photos[0] | relative_url }}" alt="{{ page.title }}" itemprop="image">
      </a>
    </div>
  {% endif %}

  {% if page.summary %}
    <p class="lead" itemprop="abstract">{{ page.summary }}</p>
  {% endif %}

  {% if page.tags %}
    <div class="tags" aria-label="Tags">
      {% for t in page.tags %}
        <span class="tag">{{ t }}</span>
      {% endfor %}
    </div>
  {% endif %}

  {% if page.detail %}
  <h2>Detail</h2>
  <div class="content">
    {{ page.detail | markdownify }}
  </div>
{% endif %}

  <div class="content" itemprop="text">
    {{ content }}
  </div>

  {% if page.photos and page.photos.size > 1 %}
    <h2>Gallery</h2>
    <div class="card-grid">
      {% for p in page.photos offset:1 %}
        <div class="card">
          <a
            class="gallery-item"
            href="{{ p | relative_url }}"
            data-full="{{ p | relative_url }}"
            data-alt="{{ page.title | escape }}"
            data-caption="{{ page.summary | escape }}"
            aria-label="Open image"
          >
            <img src="{{ p | relative_url }}" alt="">
          </a>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Prev/Next within the portfolio collection -->
  {% assign items = site.portfolio | sort: 'date' %}
  {% assign curr_index = nil %}
  {% for it in items %}
    {% if it.url == page.url %}
      {% assign curr_index = forloop.index0 %}
    {% endif %}
  {% endfor %}

  {% if curr_index != nil %}
    {% assign prev_index = curr_index | minus: 1 %}
    {% assign next_index = curr_index | plus: 1 %}
    {% assign prev_item = items[prev_index] %}
    {% assign next_item = items[next_index] %}
    <nav class="pager" aria-label="Portfolio pagination" style="margin-top:1.5rem; display:flex; justify-content:space-between; gap:1rem;">
      <div>
        {% if prev_item %}
          <a class="btn" href="{{ prev_item.url | relative_url }}">← Previous</a>
        {% endif %}
      </div>
      <div>
        {% if next_item %}
          <a class="btn" href="{{ next_item.url | relative_url }}">Next →</a>
        {% endif %}
      </div>
    </nav>
  {% endif %}
</article>

<!-- Lightbox modal -->
<div class="lightbox" id="lightbox" aria-hidden="true">
  <button class="lightbox-close" aria-label="Close">×</button>
  <div class="lightbox-inner">
    <img id="lightbox-img" alt="">
    <div class="lightbox-meta" id="lightbox-meta" hidden>
      <div class="lightbox-alt" id="lightbox-alt"></div>
      <div class="lightbox-caption" id="lightbox-caption"></div>
    </div>
  </div>
</div>

<script>
(function(){
  const lb = document.getElementById('lightbox');
  const img = document.getElementById('lightbox-img');
  const meta = document.getElementById('lightbox-meta');
  const altEl = document.getElementById('lightbox-alt');
  const capEl = document.getElementById('lightbox-caption');
  const closeBtn = lb.querySelector('.lightbox-close');

  function openLB(src, altText, caption){
    img.src = src;
    img.alt = altText || '';
    const hasAlt = !!(altText && altText.trim().length);
    const hasCap = !!(caption && caption.trim().length);
    altEl.textContent = hasAlt ? altText : '';
    capEl.textContent = hasCap ? caption : '';
    meta.hidden = !(hasAlt || hasCap);
    lb.classList.add('open');
    lb.setAttribute('aria-hidden','false');
  }
  function closeLB(){
    lb.classList.remove('open');
    lb.setAttribute('aria-hidden','true');
    img.removeAttribute('src');
    img.removeAttribute('alt');
    meta.hidden = true;
    altEl.textContent = '';
    capEl.textContent = '';
  }

  document.addEventListener('click', function(e){
    const a = e.target.closest('.gallery-item');
    if (a){
      e.preventDefault();
      openLB(
        a.getAttribute('data-full'),
        a.getAttribute('data-alt') || '',
        a.getAttribute('data-caption') || ''
      );
    }
  });

  lb.addEventListener('click', function(e){
    if (!e.target.closest('.lightbox-inner')) closeLB();
  });
  closeBtn.addEventListener('click', closeLB);
  document.addEventListener('keydown', function(e){
    if (e.key === 'Escape') closeLB();
  });
})();
</script>